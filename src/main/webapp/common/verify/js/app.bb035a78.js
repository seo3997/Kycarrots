(function(e){function t(t){for(var i,o,l=t[0],r=t[1],c=t[2],u=0,m=[];u<l.length;u++)o=l[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&m.push(n[o][0]),n[o]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);d&&d(t);while(m.length)m.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],i=!0,l=1;l<a.length;l++){var r=a[l];0!==n[r]&&(i=!1)}i&&(s.splice(t--,1),e=o(o.s=a[0]))}return e}var i={},n={app:0},s=[];function o(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=i,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(a,i,function(t){return e[t]}.bind(null,i));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/common/verify/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=r;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";a("85ec")},"057a":function(e,t,a){"use strict";a.r(t),a.d(t,"install",(function(){return n}));a("99af");var i=a("b279");function n(e){e.isElectron=i["b"],e.mixin({computed:{isElectron:function(){return e.isElectron}}}),e.prototype.alert=function(e){alert(e,"Annotation Tool")},e.prototype.confirm=function(e){return confirm(e,"Annotation Tool")},e.prototype.deepCopy=function(e){return JSON.parse(JSON.stringify(e))},e.prototype.EventBus=new e({methods:{on:function(e,t){this.$off(e).$on(e,t)},emit:function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];this.$emit.apply(this,[e].concat(a))}}})}},"1d34":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"content-main"}},[a("div",{staticClass:"wrap_tool"},[a("div",{staticClass:"inner"},[a("div",{staticClass:"tool_box cpt_left"},[a("div",{staticClass:"to_headersub"},[a("div",{staticClass:"to_btn_wrap"},[a("div",{staticClass:"btn_to upload"},[a("label",[a("input",{attrs:{type:"file",accept:"video/*",id:"videoFile"},on:{change:e.fnVideoLoaded}}),e._v("파일 열기 ")])])])]),a("div",{staticClass:"cpt_left_box"},[a("div",{staticClass:"cpt_video_wrap"},[a("div",{staticClass:"video_control"},[e.videoLoaded?a("div",{staticClass:"play_time"},[e._v(" "+e._s(e.videoCurrentMin)+":"+e._s(e.videoCurrentSec)+" / "+e._s(e.videoDurationMin)+":"+e._s(e.videoDurationSec)+" ")]):e._e(),e.isPlaying?a("button",{staticClass:"btn_video pause",attrs:{type:"button",title:"Pause"},on:{click:e.fnPauseVideo}},[a("i"),e._v("Pause")]):a("button",{staticClass:"btn_video play",attrs:{type:"button",title:"Play"},on:{click:e.fnPlayVideo}},[a("i"),e._v("Play")]),a("button",{staticClass:"btn_video capture",attrs:{type:"button",title:"Capture"},on:{click:e.fnCapture}},[a("i"),e._v("Capture")])]),a("div",{staticClass:"video_player"},[a("video",{attrs:{id:"video",muted:""},domProps:{muted:!0}},[a("source",{attrs:{src:""}}),e._v(" 브라우저가 비디오 태그를 지원하지 않습니다. ")]),a("div",{staticClass:"custom_bar",attrs:{id:"customBar"},on:{click:e.fnClickBar}},[a("div",{staticClass:"bar_current",attrs:{id:"progressBar"},on:{click:e.fnClickBar}})])])])])]),a("div",{staticClass:"tool_box cpt_right"},[a("div",{staticClass:"to_headersub"},[a("div",{staticClass:"to_btn_wrap"},[a("button",{staticClass:"btn_to",attrs:{type:"button"},on:{click:e.fnOpenSavePopup}},[e._v("저장")])])]),e._m(0)])])])])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cpt_right_box"},[a("div",{staticClass:"cpt_img_wrap"},[a("div",{staticClass:"cpt_result"},[a("canvas",{attrs:{id:"captureCanvas"}})])])])}],s=(a("baa5"),a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("b279")),o=(a("ac1f"),a("5319"),{methods:{fnOpenSavePopup:function(){var e=a("3e8f"),t=a("bdb9").remote.dialog,i=1,n=this.defaultSavePath+"/"+this.videoFileName+"_"+i+".png";while(e.existsSync(n))i++,n=this.defaultSavePath+"/"+this.videoFileName+"_"+i+".png";var s={defaultPath:n},o=t.showSaveDialogSync(s);if(o&&!(o.length<1)){this.defaultSavePath=o.substring(0,o.lastIndexOf("\\"));var l=document.getElementById("captureCanvas"),r=l.toDataURL("image/png"),c=r.replace(/^data:image.+;base64,/,"");e.writeFileSync(o,c,"base64")}}},mounted:function(){var e=this;e.EventBus.on("GO_BOUNDING_BOX",(function(){var t=e.confirm("저장하지 않은 데이터는 모두 삭제됩니다. 이동 하시겠습니까?");e.EventBus.emit("GO_BOUNDING_BOX_RESULT",t)})),e.EventBus.on("GO_VERIFICATION",(function(){var t=e.confirm("저장하지 않은 데이터는 모두 삭제됩니다. 이동 하시겠습니까?");e.EventBus.emit("GO_VERIFICATION_RESULT",t)})),e.EventBus.on("GO_CAPTURE",(function(){e.EventBus.emit("GO_CAPTURE_RESULT",!1)})),this.elVideo=document.getElementById("video"),this.elCustomBar=document.getElementById("customBar"),this.elCurrentBar=document.getElementById("progressBar");var t=a("bdb9").remote.app;this.defaultSavePath=t.getPath("documents")}}),l={name:"capture",mixins:s["b"]?[o]:[],data:function(){return{elVideo:void 0,elCustomBar:void 0,elCurrentBar:void 0,videoLoaded:!1,videoFileName:"",videoInterval:void 0,videoDurationMin:"00",videoDurationSec:"00",videoCurrentMin:"00",videoCurrentSec:"00",isPlaying:!1,defaultSavePath:""}},methods:{fnCapture:function(){if(this.videoLoaded){var e=document.getElementById("captureCanvas");e.width=this.elVideo.offsetWidth,e.height=this.elVideo.offsetHeight;var t=e.getContext("2d");t.drawImage(this.elVideo,0,0,e.width,e.height);var a=new Image;a.onload=function(){e.width=a.width,e.height=a.height,t.drawImage(a,0,0,a.width,a.height,0,0,e.width,e.height)},a.src=e.toDataURL(),this.fnPauseVideo()}},fnClickBar:function(e){if(this.videoLoaded){var t=e.offsetX,a=t*this.elVideo.duration/this.elCustomBar.offsetWidth;this.elVideo.currentTime=a;var i=parseInt(this.elVideo.currentTime/60,10),n=parseInt(this.elVideo.currentTime%60,10);if(this.videoCurrentMin=i<10?"0"+i:i,this.videoCurrentSec=n<10?"0"+n:n,0===this.elVideo.currentTime)this.elCurrentBar.style.width="0%";else{var s=this.elVideo.currentTime/this.elVideo.duration*100;this.elCurrentBar.style.width=s+"%"}}},fnPlayVideo:function(){this.videoLoaded?(this.isPlaying=!0,this.elVideo.play(),this.videoInterval=window.setInterval(this.fnVideoPlaying,500)):document.getElementById("videoFile").click()},fnPauseVideo:function(){this.videoLoaded&&(window.clearInterval(this.videoInterval),this.isPlaying=!1,this.elVideo.pause())},fnVideoPlaying:function(){if(this.elVideo.ended)this.elCurrentBar.style.width="0px",this.isPlaying=!1,window.clearInterval(this.videoInterval);else if(0===this.elVideo.currentTime)this.elCurrentBar.style.width="0%";else{var e=this.elVideo.currentTime/this.elVideo.duration*100;this.elCurrentBar.style.width=e+"%";var t=parseInt(this.elVideo.currentTime/60,10),a=parseInt(this.elVideo.currentTime%60,10);this.videoCurrentMin=t<10?"0"+t:t,this.videoCurrentSec=a<10?"0"+a:a}},fnVideoLoaded:function(e){var t=window.URL.createObjectURL(e.target.files[0]);this.videoFileName=e.target.files[0].name.substring(0,e.target.files[0].name.lastIndexOf(".")),this.elVideo.src=t,this.videoLoaded=!0;var a=this;this.elVideo.addEventListener("loadedmetadata",(function(){var e=parseInt(a.elVideo.duration/60,10),t=parseInt(a.elVideo.duration%60,10);a.videoDurationMin=e<10?"0"+e:e,a.videoDurationSec=t<10?"0"+t:t}))}}},r=l,c=(a("a0dd"),a("2877")),d=Object(c["a"])(r,i,n,!1,null,"431151aa",null);t["default"]=d.exports},"2b9e":function(e,t,a){},"37d8":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"content-main"}},[a("div",{staticClass:"wrap_tool"},[a("div",{staticClass:"to_headersub"},[a("div",{staticClass:"to_btn_wrap"},[a("button",{staticClass:"btn_to upload",attrs:{type:"button"},on:{click:e.fnOpenFileDialog}},[e._v("파일 열기")]),a("button",{staticClass:"btn_to",attrs:{type:"button"},on:{click:e.fnOpenSavePoup}},[e._v("저장")]),a("input",{staticStyle:{display:"none"},attrs:{type:"file",multiple:"",id:"imageFiles",accept:"image/jpeg, image/png"},on:{change:e.fnImageLoaded}})])]),a("div",{staticClass:"inner"},[a("div",{staticClass:"tool_box left"},[a("div",{staticClass:"upload_list",attrs:{"data-simplebar":""}},[a("ul",e._l(e.imageList,(function(t,i){return a("li",{key:i,on:{click:function(t){return e.fnSelectImage(i)}}},[a("div",{staticClass:"upload_thumb"},[a("div",{staticClass:"thumb_img",class:t.selected?"current":""},[a("div",{staticClass:"thumb_img_brd hover"}),a("img",{attrs:{id:"image"+i}})]),a("div",{staticClass:"thumb_name"},[a("span",{attrs:{title:t.fileName}},[e._v(e._s(t.fileName))])])])])})),0)])]),a("div",{staticClass:"tool_box center"},[a("div",{staticClass:"tool_head"},[a("div",{staticClass:"head_util"},[a("div",{staticClass:"tool_opt_list"},[e._m(0),a("ul",{staticClass:"tool_zoom_items"},[a("li",[a("em",{staticClass:"tool_option plus",attrs:{title:"확대"},on:{click:e.fnZoomIn}}),a("i",{staticClass:"blind"},[e._v("확대")])]),a("li",[a("em",{staticClass:"tool_option minus",attrs:{title:"축소"},on:{click:e.fnZoomOut}}),a("i",{staticClass:"blind"},[e._v("축소")])]),a("li",[a("em",{staticClass:"tool_option reset",attrs:{title:"원래대로"},on:{click:e.fnInitScale}}),a("i",{staticClass:"blind"},[e._v("원래대로")])])])]),a("div",{staticClass:"tool_opt_move",class:[e.zoomCount>0?"active":"",e.isMoveMode?"on":""],attrs:{title:"이동"},on:{click:e.fnChangeModeMove}},[a("i",{staticClass:"blind"},[e._v("이동")])])]),a("div",{staticClass:"head_file"},[a("span",[e._v("파일명")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedImage.newFileName,expression:"selectedImage.newFileName"}],staticClass:"form_file_name",attrs:{type:"text",name:""},domProps:{value:e.selectedImage.newFileName},on:{input:function(t){t.target.composing||e.$set(e.selectedImage,"newFileName",t.target.value)}}}),a("em",{staticStyle:{display:"none"}},[e._v("."+e._s(e.selectedImage.fileExtension))])])]),a("div",{staticClass:"tool_body"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.imageLoading||e.saveLoading,expression:"imageLoading || saveLoading"}],staticClass:"loading_container"},[a("div",{staticClass:"loader"}),e.imageLoading?a("p",{staticStyle:{"margin-top":"10px",color:"#f7f7f7"}},[e._v("이미지를 불러오는 중입니다...")]):e.saveLoading?a("p",{staticStyle:{"margin-top":"10px",color:"#f7f7f7"}},[e._v("데이터셋 저장 중입니다...")]):e._e()]),a("div",{staticClass:"canvas_container",attrs:{id:"canvasContainer"}},e._l(e.imageList,(function(t,i){return a("canvas",{directives:[{name:"show",rawName:"v-show",value:e.selectedImageIndex===i,expression:"selectedImageIndex === index"}],key:i,attrs:{id:"labelCanvas"+i}})})),0)]),a("div",{staticClass:"tool_foot"},[a("div",{staticClass:"foot_status"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.statusSaved,expression:"statusSaved"}],staticClass:"complete_icon"}),e._v(" "+e._s(e.statusText)+" ")])])]),a("div",{staticClass:"tool_box right"},[a("div",{staticClass:"tool_label",staticStyle:{height:"35%"}},[a("div",{staticClass:"label_tp"},[a("div",{staticClass:"tool_label_tit"},[e._v("라벨 목록")]),a("div",{staticClass:"label_tool_sel"},[e._m(1),a("div",{staticClass:"label_tool_list"},[a("em",{staticClass:"label_tool select",attrs:{title:"Select 툴"},on:{click:function(t){return e.fnAddLabel("S")}}},[a("span",[e._v("Select툴")])]),a("em",{staticClass:"label_tool crop",attrs:{title:"Crop 툴"},on:{click:function(t){return e.fnAddLabel("C")}}},[a("span",[e._v("Crop툴")])])])])]),a("div",{staticClass:"label_cont"},[a("div",{staticClass:"label_list",attrs:{"data-simplebar":""}},[a("ul",e._l(e.selectedImage.labelList,(function(t,i){return a("li",{key:i},[a("div",{staticClass:"label_wrap"},[a("div",{staticClass:"label_input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"label.text"}],staticClass:"label_text_input",attrs:{id:"labelText"+i,type:"text",readonly:!t.selected,value:""},domProps:{value:t.text},on:{focus:function(t){return e.fnSelectLabel(i)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.fnCompleteLabel(i)},input:function(a){a.target.composing||e.$set(t,"text",a.target.value)}}})]),a("div",{staticClass:"label_bounding"},e._l(t.boundingBoxes,(function(t,n){return a("em",{key:n,class:t.selected?"selected":"",attrs:{title:"클릭 시 해당 바운딩박스가 삭제됩니다."},on:{mouseover:function(t){return e.fnHoverBbox(i,n)},mouseleave:function(t){return e.fnLeaveBbox(i,n)},click:function(t){return e.fnDeleteBbox(i,n)}}})})),0),a("div",{staticClass:"label_control"},[a("button",{staticClass:"btn_label save",attrs:{type:"button",title:"완료"},on:{click:function(t){return e.fnCompleteLabel(i)}}},[a("i",{staticClass:"blind"},[e._v("완료")])]),a("button",{staticClass:"btn_label delete",attrs:{type:"button",title:"삭제"},on:{click:function(t){return e.fnDeleteLabel(i)}}},[a("i",{staticClass:"blind"},[e._v("삭제")])])])])])})),0)])])]),a("div",{staticClass:"tool_meta"},[a("div",{staticClass:"label_tp"},[a("div",{staticClass:"tool_label_tit"},[e._v("메타 데이터")]),a("div",{staticClass:"label_tool_sel"},[a("div",{staticClass:"label_tool save",attrs:{title:"저장"},on:{click:function(t){return e.fnCompleteMeta()}}},[a("span")])])]),a("div",{staticClass:"label_cont"},[a("div",{staticClass:"meta_list_wrap",attrs:{id:"simple"}},[a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("분류")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.metaclass,expression:"metadata.metaclass"}],on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"metaclass",t.target.multiple?a:a[0])},function(t){return e.fnGetOptions()}]}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("실외간판")]),a("option",[e._v("실내간판")]),a("option",[e._v("책표지")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("세분류")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.subclass,expression:"metadata.subclass"}],domProps:{innerHTML:e._s(e.subclass_html)},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"subclass",t.target.multiple?a:a[0])}}})]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("지역")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.area,expression:"metadata.area"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"area",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("수도권")]),a("option",[e._v("충청권")]),a("option",[e._v("전라권")]),a("option",[e._v("경상권")]),a("option",[e._v("강원권")]),a("option",[e._v("제주권")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("수집장치")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.device,expression:"metadata.device"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"device",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("스마트폰")]),a("option",[e._v("DSLR")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("날씨")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.weather,expression:"metadata.weather"}],domProps:{innerHTML:e._s(e.weather_html)},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"weather",t.target.multiple?a:a[0])}}})]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("조도")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.illuminance,expression:"metadata.illuminance"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"illuminance",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("밝음")]),a("option",[e._v("중간")]),a("option",[e._v("어두움")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("광원")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.light,expression:"metadata.light"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"light",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("자연광")]),a("option",[e._v("간접광")]),a("option",[e._v("자체발광")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("외곽선 선명도")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.outline,expression:"metadata.outline"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"outline",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("상")]),a("option",[e._v("중")]),a("option",[e._v("하")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("글씨방향")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.wordorientation,expression:"metadata.wordorientation"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"wordorientation",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("가로")]),a("option",[e._v("세로")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("글씨크기")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.wordsize,expression:"metadata.wordsize"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"wordsize",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("대")]),a("option",[e._v("중")]),a("option",[e._v("소")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("글씨폰트")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.wordfont,expression:"metadata.wordfont"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"wordfont",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("활자체")]),a("option",[e._v("캘리그라피")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("글자색")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.wordcolor,expression:"metadata.wordcolor"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"wordcolor",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("단색")]),a("option",[e._v("여러색")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("글자연결")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.metadata.wordconnection,expression:"metadata.wordconnection"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.metadata,"wordconnection",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v("선택하세요")]),a("option",[e._v("빈공간으로나뉨")]),a("option",[e._v("빈공간없이이어짐")])])])])])])])])]),e.imageLoading||e.saveLoading?a("div",{staticClass:"whole_dim"}):e._e(),a("dataset-save-popup",{attrs:{eventBusID:"AnnotationToolDatasetSaveEvent"}})],1)},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"option_head"},[a("em",{staticClass:"tool_option default",attrs:{title:"축소/확대 선택"}}),a("i",{staticClass:"blind"},[e._v("축소/확대 선택")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"label_tool add",attrs:{title:"라벨 추가"}},[a("span",[e._v("추가")])])}],s=(a("4de4"),a("4160"),a("baa5"),a("45fc"),a("a434"),a("b0c0"),a("4fad"),a("b64b"),a("d3b7"),a("ac1f"),a("3ca3"),a("1276"),a("159b"),a("ddb0"),a("2b3d"),a("3835")),o=a("1157"),l=a.n(o),r=(a("d81d"),a("96cf"),a("1da1")),c=a("d4ec"),d=a("bee2"),u=a("c4e3"),m=a.n(u),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.a;Object(c["a"])(this,e),this.entities=[],this.current=null,this.zipAPI=t}return Object(d["a"])(e,[{key:"prepare",value:function(e){var t=new h(e);this.entities.push(t),this.current=this.entities[this.entities.length-1]}},{key:"addImage",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.current.images.push({name:e,contents:t,options:a})}},{key:"setDataset",value:function(e){this.current.dataset=e}},{key:"finalize",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.entities.map(this.$_generateAsyncZip,this),e.next=3,Promise.all(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"$_generateAsyncZip",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new this.zipAPI,t.addImagesToZip(a),i="".concat(t.title,"_info.json"),t.addJsonToZop(a,i),e.next=6,a.generateAsync({type:"blob"});case 6:return n=e.sent,e.abrupt("return",{name:"".concat(t.title,".zip"),content:n});case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"$_mainImageName",get:function(){return this.entities[0].images[0].name}}]),e}(),h=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(c["a"])(this,e),this.title=t,this.images=a,this.dataset=i,this.metaData=n}return Object(d["a"])(e,[{key:"addImagesToZip",value:function(e){var t=this;this.images.forEach((function(a){t.$_addImageToZip(a,e)}),this)}},{key:"addJsonToZop",value:function(e,t){e.file(t,JSON.stringify(this.dataset,null,4))}},{key:"$_addImageToZip",value:function(e,t){t.file(e.name,e.contents,e.options)}}]),e}(),g=(a("99af"),function(){function e(t){var a=t.images,i=t.annotations,n=t.cropLabels,s=t.info,o=void 0===s?{name:"",description:"",date_created:""}:s,l=t.metadata,r=void 0===l?{metaclass:"",subclass:"",area:"",device:"",weather:"",illuminance:"",light:"",outline:"",wordorientation:"",wordsize:"",wordfont:"",wordcolor:"",wordconnection:""}:l;Object(c["a"])(this,e),this.images=a||[],this.annotations=i||[],this.cropLabels=n||[],this.info=o,this.metadata=r}return Object(d["a"])(e,[{key:"merge",value:function(e){this.images=this.images.concat(e.images),this.annotations=this.annotations.concat(e.annotations),this.cropLabels=this.cropLabels.concat(e.cropLabels)}}]),e}()),f=a("9072"),p=a("b85c"),_=a("262e"),b=a("2caf"),w=a("bc3a"),I=a.n(w),C=a("b279"),x=M,y={HIDDEN_INPUTS:["user_no","ss_user_no","company_id","project_id"],UPLOAD:"upload",LABEL:"label"},L=C["a"]?"http://localhost:5000/uploads":"/front/work/insertWorkAjax.do";function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return C["b"]?new E(e):new S(e)}var O=function(){function e(){Object(c["a"])(this,e)}return Object(d["a"])(e,[{key:"appendFile",value:function(e,t){}},{key:"appendHiddenValues",value:function(e){}},{key:"upload",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),S=function(e){Object(_["a"])(a,e);var t=Object(b["a"])(a);function a(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(c["a"])(this,a),e=t.call(this,i),e.formData=i.formData||new FormData,e}return Object(d["a"])(a,[{key:"appendFile",value:function(e,t,a){this.formData.append(y.UPLOAD,t,e),this.formData.append(y.LABEL,a)}},{key:"appendHiddenValues",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.HIDDEN_INPUTS,a=Object(p["a"])(t);try{for(a.s();!(e=a.n()).done;){var i=e.value;try{var n=Object(C["c"])(i);this.formData.append(n.key,n.value)}catch(s){alert(s)}}}catch(o){a.e(o)}finally{a.f()}}},{key:"upload",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$_uploadFormData(this.formData);case 2:if(t=e.sent,a=t.data,"error"!==a.resultCode){e.next=6;break}throw new R(a.resultMsg);case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"$_uploadFormData",value:function(e){return I()({method:"post",url:L,data:e,headers:{"Content-Type":"multipart/form-data"}})}}]),a}(O),E=function(e){Object(_["a"])(i,e);var t=Object(b["a"])(i);function i(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(c["a"])(this,i),e=t.call(this,a),e.savePath=a.savePath||"",e.promises=[],e}return Object(d["a"])(i,[{key:"appendFile",value:function(e,t,a){var i=this.$_writeFile(e,t);this.promises.push(i)}},{key:"upload",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.promises);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"$_writeFile",value:function(e,t){var i=this,n=a("3e8f"),s=a("df7c"),o=this.savePath+s.sep+e;return new Promise((function(e,a){var s=n.createWriteStream(o);return s.on("finish",(function(){return e()})),s.on("error",(function(e){return a(e)})),i.$_writeBlobToStream(t,s)}))}},{key:"$_writeBlobToStream",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,i){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=a("1c35").Buffer,e.next=3,t.arrayBuffer().then((function(e){i.write(n.from(e)),i.end()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));function t(t,a){return e.apply(this,arguments)}return t}()}]),i}(O),R=function(e){Object(_["a"])(a,e);var t=Object(b["a"])(a);function a(){var e;Object(c["a"])(this,a);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return e=t.call.apply(t,[this].concat(n)),e.name="FormDataComposerError",e}return a}(Object(f["a"])(Error)),F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"layerpop pop_dataset",attrs:{id:"layerbox"}},[a("div",{staticClass:"layerpop_area"},[e._m(0),a("div",{staticClass:"pop_body"},[a("ul",{staticClass:"dataset_info"},[a("li",{staticStyle:{display:"none"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.datasetSaveInfo.name,expression:"datasetSaveInfo.name"}],attrs:{type:"text",id:"name",placeholder:"카테고리"},domProps:{value:e.datasetSaveInfo.name},on:{input:function(t){t.target.composing||e.$set(e.datasetSaveInfo,"name",t.target.value)}}})]),a("li",{staticStyle:{display:"none"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.datasetSaveInfo.fileName,expression:"datasetSaveInfo.fileName"}],attrs:{type:"text",id:"fileName",placeholder:"파일명"},domProps:{value:e.datasetSaveInfo.fileName},on:{input:function(t){t.target.composing||e.$set(e.datasetSaveInfo,"fileName",t.target.value)}}})]),e.isElectron?a("li"):a("li",{staticStyle:{color:"black"}},[e._v(" 저장하시겠습니까? ")]),e.isElectron?a("li",[a("div",{staticClass:"to_srchbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.datasetSaveInfo.savePath,expression:"datasetSaveInfo.savePath"}],attrs:{type:"text",readonly:"",placeholder:"저장 경로"},domProps:{value:e.datasetSaveInfo.savePath},on:{input:function(t){t.target.composing||e.$set(e.datasetSaveInfo,"savePath",t.target.value)}}}),a("input",{attrs:{type:"submit",title:"검색"},on:{click:e.fnOpenPath}})])]):e._e()])]),a("div",{staticClass:"pop_footer"},[a("a",{staticClass:"btn_to_pop",attrs:{href:"javascript:;"},on:{click:function(t){return t.preventDefault(),e.fnPopupSave(t)}}},[e._v("저장")]),a("a",{staticClass:"pop_close btn_to_pop",attrs:{href:"javascript:;",id:"layerbox_close"},on:{click:function(t){return t.preventDefault(),e.fnPopupClose(t)}}},[e._v("닫기")])])])])},k=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pop_title"},[a("span",[e._v("데이터셋")])])}],B={fnPopupSave:function(){this.EventBus.emit(this.eventBusID,this.datasetSaveInfo),this.fnPopupClose()}},D={methods:B},P="savePath",T={fnPopupSave:function(){this.datasetSaveInfo.savePath?(this.EventBus.emit(this.eventBusID,this.datasetSaveInfo),this.fnPopupClose()):this.alert("데이터셋 저장 경로를 선택해주세요.")},fnOpenPath:function(){var e=a("bdb9").remote.dialog,t=e.showOpenDialogSync({properties:["openDirectory"]});this.datasetSaveInfo.savePath=t[0],window.localStorage.setItem(P,t[0])}},N={oldSavePath:function(){return window.localStorage.getItem(P)}},j={methods:T,computed:N},z={name:"DatasetSavePopup",props:["eventBusID"],mixins:C["b"]?[j]:[D],data:function(){return{datasetSaveInfo:{name:"",fileName:"",savePath:""}}},methods:{fnPopupOpen:function(){this.remindSavePath(),l()(".layerpop").css("position","absolute"),l()(".layerpop").css("top",(l()(window).height()-l()(".layerpop").outerHeight())/2+l()(window).scrollTop()),l()(".layerpop").css("left",(l()(window).width()-l()(".layerpop").outerWidth())/2+l()(window).scrollLeft()),l()("#layerbox").show(),l()("#name").focus()},fnPopupClose:function(){l()("#layerbox").hide(),l()("#mask").hide(),this.datasetSaveInfo={name:"",fileName:"",savePath:""}},remindSavePath:function(){this.oldSavePath&&(this.datasetSaveInfo.savePath=this.oldSavePath)}},mounted:function(){this.remindSavePath(),this.EventBus.on("DatasetSavePopupOpen",this.fnPopupOpen)}},X=z,Y=a("2877"),W=Object(Y["a"])(X,F,k,!1,null,"4a3c9888",null),H=W.exports,$=function(){var e=this;this.registerEventsWhenMounted(),window.onresize=function(){e.fnSetCanvasResize()}},U={mounted:$},A=function(){var e=this;this.registerEventsWhenMounted();var t=a("bdb9").remote.getCurrentWindow();t.on("resize",(function(){e.fnSetCanvasResize()})),t.on("maximize",(function(){e.fnSetCanvasResize()})),t.on("unmaximize",(function(){e.fnSetCanvasResize()})),t.on("minimize",(function(){e.fnSetCanvasResize()})),t.on("restore",(function(){e.fnSetCanvasResize()}))},V={mounted:A},G={"dataset-save-popup":H},J=function(){return{datasetInfo:{},initCanvasWidth:0,initCanvasHeight:0,windowWidthRatio:1,windowHeightRatio:1,statusText:"이미지를 선택해주세요.",statusSaved:!1,image:null,saveLoading:!1,imageLoading:!1,canvas:null,context:null,mouseIsDown:!1,canvasInterval:null,rectangles:[],imageList:[],selectedImage:{},selectedImageIndex:-1,labelList:[],selectedLabel:{},selectedBbox:{},startX:0,startY:0,endX:0,endY:0,canvasScaleFactor:1.1,scaleFactor:null,zoomCount:0,zoomInExp:3,zoomOutExp:-3,imageMoveX:0,imageMoveY:0,isMoveMode:!1,newLabelSelectType:{selected:!0,type:"S",text:"",boundingBoxes:[]},newLabelCropType:{selected:!0,type:"C",text:"",boundingBox:{}},metadata:{metaclass:"",subclass:"",area:"",device:"",weather:"",illuminance:"",light:"",outline:"",wordorientation:"",wordsize:"",wordfont:"",wordcolor:"",wordconnection:""},metadataTitle:{metaclass:"분류",subclass:"세분류",area:"지역",device:"수집장치",weather:"날씨",illuminance:"조도",light:"광원",outline:"외곽선 선명도",wordorientation:"글씨방향",wordsize:"글씨크기",wordfont:"글씨폰트",wordcolor:"글자색",wordconnection:"글자연결"},subclass_html:'<option value="" disabled selected >분류를 선택하세요</option>',weather_html:'<option value="" disabled selected >분류를 선택하세요</option>'}},Z={isAllLabelCompleted:function(){var e=this,t=!0;return e.selectedImage.labelList&&e.selectedImage.labelList.length>0&&e.selectedImage.labelList.forEach((function(e){e.selected&&(t=!1)})),t}},q={fnGetDatasetSaveInfo:function(e){this.datasetInfo=this.deepCopy(e),this.fnSaveDataset()},fnGetOptions:function(){var e,t=this.metadata.metaclass,a=["가로형간판","세로형간판","돌출간판","지주이용 간판","현수막","창문이용광고물"],i=["실내간판","실내안내판"],n=["총류","철학","종교","사회과학","순수과학","기술과학","예술","언어","문학","역사","기타(유아)"],s=["맑음","흐림","눈","비"],o='<option value="" disabled selected hidden>선택하세요</option>',l=o,r=o;if(""!=t){if("실외간판"==t){e=a;for(var c=0;c<s.length;c++)r=r+"<option>"+s[c]+"</option>"}else"실내간판"==t?(e=i,r="<option disabled selected>선택없음</option>"):"책표지"==t&&(e=n,r="<option disabled selected>선택없음</option>");this.subclass_html=o;for(c=0;c<e.length;c++)l=l+"<option>"+e[c]+"</option>";this.subclass_html=l,this.metadata.subclass="",this.weather_html=r,this.metadata.weather="실외간판"==t?"":"선택없음"}},fnOpenSavePoup:function(){var e=this;if(!e.selectedImage.labelList||e.selectedImage.labelList.length<1)e.alert("저장할 라벨 정보가 없습니다.");else{var t=!1;if(e.imageList.some((function(e){if(!e.labelList||e.labelList.length<1)return t=!0,!0})),e.isAllLabelCompleted){var a=!0;t&&!e.confirm("작업이 진행되지 않은 이미지는 저장되지 않습니다.\n계속 하시겠습니까?")&&(a=!1),a&&(this.EventBus.on("AnnotationToolDatasetSaveEvent",this.fnGetDatasetSaveInfo),this.EventBus.emit("DatasetSavePopupOpen",{}))}else e.alert("완료되지 않은 라벨이 있습니다.")}},fnSaveDataset:function(){var e=this,t=this;t.fnInitScale(),t.saveLoading=!0,t.imageList.forEach((function(t){var a=e._.filter(e.imageList,(function(e){return o(e)===o(t)}));a.length>1&&a.forEach((function(e,a){t.seq!==e.seq&&(e.newFileName=e.newFileName+"_"+(a+1))}))}));var a=new v,i=0,n=0;t.imageList.forEach((function(s){if(s.labelList&&!(s.labelList.length<1)){a.prepare(s.newFileName);var r=new g({images:[],annotations:[],cropLabels:[],info:{name:s.newFileName,description:"",date_created:t.$moment(new Date).format("YYYY-MM-DD HH:mm:ss")},metadata:{metaclass:s.metadata.metaclass,subclass:s.metadata.subclass,area:s.metadata.area,device:s.metadata.device,weather:s.metadata.weather,illuminance:s.metadata.illuminance,light:s.metadata.light,outline:s.metadata.outline,wordorientation:s.metadata.wordorientation,wordsize:s.metadata.wordsize,wordfont:s.metadata.wordfont,wordcolor:s.metadata.wordcolor,wordconnection:s.metadata.wordconnection}}),c=t._.filter(s.labelList,(function(e){return"S"===e.type}));c&&c.length>0&&(a.addImage(o(s),s.file),i++,r.images.push({id:i,width:s.width,height:s.height,file_name:o(s),date_captured:t.$moment(s.file.lastModifiedDate).format("YYYY-MM-DD HH:mm:ss")})),c.forEach((function(t){t.boundingBoxes.forEach((function(a){var o=l(s,a,e);n++,r.annotations.push({id:n,image_id:i,text:t.text,bbox:[o.x,o.y,o.width,o.height]})}),e)}));var d=t._.filter(s.labelList,(function(e){return"C"===e.type}));d.forEach((function(o,c){var d=s.newFileName+"_cropped_"+c+"."+s.fileExtension,u=l(s,o.boundingBox,e),m=v(s.realImage,u).split("base64,")[1];function v(e,t){var a=document.createElement("canvas");a.width=t.width,a.height=t.height;var i=a.getContext("2d");return i.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height),a.toDataURL("image/png")}a.addImage(d,m,{base64:!0}),i++,r.images.push({id:i,width:Math.abs(u.width),height:Math.abs(u.height),file_name:d,date_captured:t.$moment(new Date).format("YYYY-MM-DD HH:mm:ss")}),n++,r.annotations.push({id:n,image_id:i,text:o.text,bbox:[0,0,Math.abs(u.width),Math.abs(u.height)]}),u=null}),e),a.setDataset(r)}}));var s=x({savePath:this.datasetInfo.savePath});function o(e){return e.newFileName+"."+e.fileExtension}function l(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,i=a.fnGetRatio(e),n=Math.ceil(e.biggerThanContainer?parseFloat(t.startX)*i:parseFloat(t.startX)/i),s=Math.ceil(e.biggerThanContainer?parseFloat(t.startY)*i:parseFloat(t.startY)/i),o=Math.ceil(e.biggerThanContainer?parseFloat(t.width)*i:parseFloat(t.width)/i),l=Math.ceil(e.biggerThanContainer?parseFloat(t.height)*i:parseFloat(t.height)/i);return n=Math.ceil(parseFloat(n)*(a.selectedImage.canvas.width/t.canvasW)),s=Math.ceil(parseFloat(s)*(a.selectedImage.canvas.height/t.canvasH)),o=Math.ceil(parseFloat(o)*(a.selectedImage.canvas.width/t.canvasW)),l=Math.ceil(parseFloat(l)*(a.selectedImage.canvas.height/t.canvasH)),{x:n,y:s,width:o,height:l}}s.appendHiddenValues(),a.finalize().then((function(e){function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;e.statusSaved=!0,e.statusText="데이터셋이 저장되었습니다.",e.saveLoading=!1,e.alert("데이터셋이 저장되었습니다."),window.location.reload(!0)}e.forEach((function(e){s.appendFile(e.name,e.content,t.datasetInfo.name)})),s.upload().then((function(){a(t)})).catch((function(e){alert("저장이 실패했습니다."),console.error(e)}))}))},fnOpenFileDialog:function(){l()("#imageFiles").click()},fnLeaveBbox:function(e,t){var a=this;a.selectedImage.labelList[e].boundingBoxes[t].selected=!1,a.fnDrawRectangle()},fnHoverBbox:function(e,t){var a=this;a.selectedImage.labelList[e].boundingBoxes.forEach((function(e){e.selected=!1})),a.selectedImage.labelList[e].boundingBoxes[t].selected=!0,a.fnDrawRectangle()},fnDeleteBbox:function(e,t){var a=this;a.selectedImage.labelList[e].boundingBoxes.splice(t,1),a.fnDrawRectangle()},fnAddLabel:function(e){var t=this,a=!0;t.selectedImage.labelList&&t.selectedImage.labelList.length>0&&t.selectedImage.labelList.forEach((function(e){e.selected&&(a=!1)})),a?(t.selectedLabel="S"===e?t.deepCopy(t.newLabelSelectType):t.deepCopy(t.newLabelCropType),(!t.selectedImage.labelList||t.selectedImage.labelList.length<1)&&(t.selectedImage.labelList=[]),t.selectedImage.labelList.push(t.selectedLabel),t.statusSaved=!1,t.statusText="라벨이 추가되었습니다.",t.$forceUpdate(),t.$nextTick((function(){var e=t.selectedImage.labelList.length-1;l()("#labelText"+e).focus(),l()(".label_tool_list").slideUp(100)}))):t.alert("완료되지 않은 라벨이 있습니다.")},fnDeleteLabel:function(e){var t=this;t.selectedImage.labelList.splice(e,1),t.$forceUpdate(),t.fnDrawRectangle()},fnSelectLabel:function(e){var t=this;t.selectedImage.labelList.forEach((function(e){e.selected=!1,"S"===e.type?e.boundingBoxes.forEach((function(e){e.selected=!1})):e.boundingBox.selected=!1})),t.selectedImage.labelList[e].selected=!0,t.selectedLabel=t.selectedImage.labelList[e],"C"===t.selectedLabel.type&&(t.selectedLabel.boundingBox.selected=!0),t.$nextTick((function(){t.fnDrawRectangle()}))},fnCompleteLabel:function(e){var t=this;if(!t.selectedImage.labelList[e].text||t.selectedImage.labelList[e].text.length<1)t.alert("텍스트 입력 후 완료가 가능합니다.");else{if("S"===t.selectedImage.labelList[e].type){if(!t.selectedImage.labelList[e].boundingBoxes||t.selectedImage.labelList[e].boundingBoxes.length<1)return void t.alert("하나 이상의 바운딩박스 지정 후 완료가 가능합니다.");t.selectedImage.labelList[e].selected=!1,t.selectedImage.labelList[e].boundingBoxes.forEach((function(e){e.selected=!1}))}else{if(!t.selectedImage.labelList[e].boundingBox.width)return void t.alert("하나 이상의 바운딩박스 지정 후 완료가 가능합니다.");t.selectedImage.labelList[e].selected=!1,t.selectedImage.labelList[e].boundingBox.selected=!1}t.selectedLabel=t.deepCopy({}),t.selectedBbox=t.deepCopy({}),t.statusSaved=!0,t.statusText="라벨정보가 저장되었습니다.",t.$forceUpdate(),t.$nextTick((function(){t.fnDrawRectangle()}))}},fnCompleteMeta:function(){for(var e=this,t=0,a=Object.entries(e.metadata);t<a.length;t++){var i=Object(s["a"])(a[t],2),n=i[0];i[1];if(""==e.metadata[n])return void alert("메타데이터 ".concat(e.metadataTitle[n],"를 입력하세요"))}e.selectedImage.metadata||(e.selectedImage.metadata={});for(var o=0,l=Object.entries(e.selectedImage.metadata);o<l.length;o++){var r=Object(s["a"])(l[o],2),c=r[0];r[1];e.selectedImage.metadata[c]=e.metadata[c]}e.alert("메타데이터가 저장되었습니다."),console.log(e.selectedImageIndex),console.log(e.selectedImage.metadata)},fnChangeModeMove:function(){var e=this;if(e.zoomCount<1)return e.isMoveMode=!1,void l()("#labelCanvas"+e.selectedImageIndex).css("cursor","default");e.isMoveMode=!e.isMoveMode,e.$forceUpdate(),e.$nextTick((function(){e.isMoveMode?l()("#labelCanvas"+e.selectedImageIndex).css("cursor","-webkit-grab"):l()("#labelCanvas"+e.selectedImageIndex).css("cursor","default")}))},fnZoomIn:function(){var e=this;Object.keys(e.selectedImage).length<1||Math.abs(e.zoomCount)>4||(e.zoomCount++,e.scaleFactor=Math.pow(e.canvasScaleFactor,e.zoomInExp),e.selectedImage.context.clearRect(0,0,e.selectedImage.width,e.selectedImage.height),e.selectedImage.context.scale(e.scaleFactor,e.scaleFactor),e.fnDrawRectangle())},fnZoomOut:function(){var e=this;Object.keys(e.selectedImage).length<1||0!==e.zoomCount&&(e.zoomCount--,e.scaleFactor=Math.pow(e.canvasScaleFactor,e.zoomOutExp),e.selectedImage.context.clearRect(0,0,e.selectedImage.width,e.selectedImage.height),e.selectedImage.context.scale(e.scaleFactor,e.scaleFactor),0===e.zoomCount&&(e.imageMoveX=0,e.imageMoveY=0,e.selectedImage.context.setTransform(1,0,0,1,e.imageMoveX,e.imageMoveY),e.fnChangeModeMove()),e.fnDrawRectangle())},fnInitScale:function(){var e=this;if(0!==e.zoomCount){var t=e.zoomCount>0;e.imageMoveX=0,e.imageMoveY=0;for(var a=0;a<Math.abs(e.zoomCount);a++)e.scaleFactor=Math.pow(e.canvasScaleFactor,t?e.zoomOutExp:e.zoomInExp),e.selectedImage.context.scale(e.scaleFactor,e.scaleFactor);e.selectedImage.context.setTransform(1,0,0,1,e.imageMoveX,e.imageMoveY),e.selectedImage.context.clearRect(0,0,e.selectedImage.width,e.selectedImage.height),e.zoomCount=0,e.fnChangeModeMove(),e.fnDrawRectangle()}},fnSetCanvasEvent:function(){var e=this;e.selectedImage.canvas.addEventListener("mousedown",e.fnMouseDown,!1),e.selectedImage.canvas.addEventListener("mousemove",e.fnMouseMove,!1),e.selectedImage.canvas.addEventListener("mouseup",e.fnMouseUp,!1)},fnMouseDown:function(){var e=this;if(e.mouseIsDown=!0,e.isMoveMode)l()("#labelCanvas"+e.selectedImageIndex).css("cursor","-webkit-grabbing");else{if(Object.keys(e.selectedLabel).length<1)return;e.selectedBbox={selected:!0},"S"===e.selectedLabel.type?e.selectedLabel.boundingBoxes.push(e.selectedBbox):e.selectedLabel.boundingBox=e.selectedBbox,e.selectedImage.context.lineWidth=4,e.selectedImage.context.strokeStyle="#f33";var t=e.selectedImage.canvas.getBoundingClientRect();if(e.startX=e.endX=event.clientX-t.left,e.startY=e.endY=event.clientY-t.top,e.startX=e.endX=e.endX+-1*e.imageMoveX,e.startY=e.endY=e.endY+-1*e.imageMoveY,0!==e.zoomCount){var a=0,i=e.zoomCount>0;a=Math.pow(e.canvasScaleFactor,i?e.zoomOutExp:e.zoomInExp);for(var n=0;n<Math.abs(e.zoomCount);n++)e.startX=e.endX=e.endX*a,e.startY=e.endY=e.endY*a}e.fnDrawRectangle(),e.canvasInterval=setInterval((function(){e.fnDrawRectangle()}),5)}},fnMouseMove:function(e){var t=this,a=t.zoomCount>0;if(t.mouseIsDown)if(t.isMoveMode){var i=0;i=Math.pow(t.canvasScaleFactor,a?t.zoomInExp*t.zoomCount:t.zoomOutExp*Math.abs(t.zoomCount)),t.imageMoveX+=e.movementX,t.imageMoveY+=e.movementY,e.movementX>0&&e.movementY>0&&t.imageMoveX>0&&t.imageMoveY>0&&(t.imageMoveX=0,t.imageMoveY=0),e.movementX>0&&t.imageMoveX>0&&(t.imageMoveX=0),e.movementY>0&&t.imageMoveY>0&&(t.imageMoveY=0);var n=0,s=0;n=Math.ceil(t.imageMoveX/(-1*(i-1))),s=Math.ceil(t.imageMoveY/(-1*(i-1))),t.imageMoveX<0&&t.imageMoveY<0&&n>t.selectedImage.canvas.width&&s>t.selectedImage.canvas.height&&(t.imageMoveX=Math.ceil(t.selectedImage.canvas.width*(-1*(i-1))),t.imageMoveY=Math.ceil(t.selectedImage.canvas.height*(-1*(i-1)))),n>t.selectedImage.canvas.width&&(t.imageMoveX=Math.ceil(t.selectedImage.canvas.width*(-1*(i-1)))),s>t.selectedImage.canvas.height&&(t.imageMoveY=Math.ceil(t.selectedImage.canvas.height*(-1*(i-1)))),t.selectedImage.context.clearRect(0,0,t.selectedImage.width,t.selectedImage.height),t.selectedImage.context.setTransform(i,0,0,i,t.imageMoveX,t.imageMoveY),t.fnDrawRectangle()}else{if(Object.keys(t.selectedLabel).length<1)return;var o=t.selectedImage.canvas.getBoundingClientRect();if(t.endX=e.clientX-o.left,t.endY=e.clientY-o.top,t.endX=t.endX+-1*t.imageMoveX,t.endY=t.endY+-1*t.imageMoveY,0!==t.zoomCount){var l=0;l=Math.pow(t.canvasScaleFactor,a?t.zoomOutExp:t.zoomInExp);for(var r=0;r<Math.abs(t.zoomCount);r++)t.endX=t.endX*l,t.endY=t.endY*l}}},fnMouseUp:function(){var e=this;if(e.mouseIsDown)if(e.mouseIsDown=!1,e.isMoveMode)l()("#labelCanvas"+e.selectedImageIndex).css("cursor","-webkit-grab");else{if(e.startX>e.endX){var t=e.startX;e.startX=e.endX,e.endX=t}if(e.startY>e.endY){var a=e.startY;e.startY=e.endY,e.endY=a}var i=e.endX-e.startX,n=e.endY-e.startY;if(i<5||n<5)return void("S"===e.selectedLabel.type&&e.selectedLabel.boundingBoxes.splice(e.selectedLabel.boundingBoxes.length-1,1));"S"===e.selectedLabel.type?e.selectedLabel.boundingBoxes[e.selectedLabel.boundingBoxes.length-1]={startX:e.startX,startY:e.startY,endX:e.endX,endY:e.endY,width:e.endX-e.startX,height:e.endY-e.startY,selected:!1,canvasW:e.selectedImage.canvas.width,canvasH:e.selectedImage.canvas.height}:(e.selectedBbox.selected=!1,e.selectedLabel.boundingBox={startX:e.startX,startY:e.startY,endX:e.endX,endY:e.endY,width:e.endX-e.startX,height:e.endY-e.startY,selected:!1,canvasW:e.selectedImage.canvas.width,canvasH:e.selectedImage.canvas.height}),e.$forceUpdate(),e.fnDrawRectangle(),clearInterval(e.canvasInterval)}},fnDrawRectangle:function(){var e=this;if(e.selectedImage.context.drawImage(e.image,0,0,e.image.width,e.image.height,0,0,e.selectedImage.canvas.width,e.selectedImage.canvas.height),e.selectedImage.labelList&&e.selectedImage.labelList.length>0&&e.selectedImage.labelList.forEach((function(t){if(e.selectedImage.context.lineWidth=4,"S"===t.type)t.boundingBoxes.forEach((function(t){t.selected?e.selectedImage.context.strokeStyle="#f33":e.selectedImage.context.strokeStyle="#111",e.selectedImage.context.setLineDash([]),e.selectedImage.context.beginPath(),e.selectedImage.context.rect(t.startX*(e.selectedImage.canvas.width/t.canvasW),t.startY*(e.selectedImage.canvas.height/t.canvasH),t.width*(e.selectedImage.canvas.width/t.canvasW),t.height*(e.selectedImage.canvas.height/t.canvasH)),e.selectedImage.context.closePath(),e.selectedImage.context.stroke()}));else{var a=t.boundingBox;a.selected?e.selectedImage.context.strokeStyle="#f33":e.selectedImage.context.strokeStyle="#111",e.selectedImage.context.globalAlpha=.1,e.selectedImage.context.fillRect(a.startX*(e.selectedImage.canvas.width/a.canvasW),a.startY*(e.selectedImage.canvas.height/a.canvasH),a.width*(e.selectedImage.canvas.width/a.canvasW),a.height*(e.selectedImage.canvas.height/a.canvasH)),e.selectedImage.context.globalAlpha=1,e.selectedImage.context.setLineDash([5,3]),e.selectedImage.context.beginPath(),e.selectedImage.context.rect(a.startX*(e.selectedImage.canvas.width/a.canvasW),a.startY*(e.selectedImage.canvas.height/a.canvasH),a.width*(e.selectedImage.canvas.width/a.canvasW),a.height*(e.selectedImage.canvas.height/a.canvasH)),e.selectedImage.context.closePath(),e.selectedImage.context.stroke()}})),e.mouseIsDown&&!e.isMoveMode){e.selectedImage.context.strokeStyle="#f33";var t=e.endX-e.startX,a=e.endY-e.startY;"C"===e.selectedLabel.type?(e.selectedImage.context.globalAlpha=.1,e.selectedImage.context.fillRect(e.startX,e.startY,t,a),e.selectedImage.context.globalAlpha=1,e.selectedImage.context.setLineDash([5,3])):e.selectedImage.context.setLineDash([]),e.selectedImage.context.beginPath(),e.selectedImage.context.rect(e.startX,e.startY,t,a),e.selectedImage.context.stroke()}},fnGetRatio:function(e){var t=l()("#canvasContainer").width(),a=l()("#canvasContainer").height();if(t<e.realImage.naturalWidth&&a<e.realImage.naturalHeight){if(e.realImage.naturalWidth>e.realImage.naturalHeight)return parseFloat(e.realImage.naturalWidth)/parseFloat(t);if(e.realImage.naturalHeight>e.realImage.naturalWidth)return parseFloat(e.realImage.naturalHeight)/parseFloat(a)}else{if(t<e.realImage.naturalWidth)return parseFloat(e.realImage.naturalWidth)/parseFloat(t);if(a<e.realImage.naturalHeight)return parseFloat(e.realImage.naturalHeight)/parseFloat(a)}if(t>e.realImage.naturalWidth||a>e.realImage.naturalHeight){var i=e.realImage.naturalWidth,n=e.realImage.naturalHeight,s=0;while(i<t-10&&n<a-10)s++,i*=1.01,n*=1.01;var o=1.01;s-=1;for(var r=0;r<s;r++)o*=1.01;return o}},fnSetCanvasSize:function(){var e=this,t=l()("#canvasContainer").width(),a=l()("#canvasContainer").height(),i=0;if(t<e.image.naturalWidth&&a<e.image.naturalHeight){if(e.selectedImage.biggerThanContainer=!0,e.image.naturalWidth>e.image.naturalHeight)return i=parseFloat(t)/parseFloat(e.image.naturalWidth),e.selectedImage.canvas.width=Math.ceil(e.image.naturalWidth*i)-5,void(e.selectedImage.canvas.height=Math.ceil(e.image.naturalHeight*i)-5);if(e.image.naturalHeight>e.image.naturalWidth)return i=parseFloat(a)/parseFloat(e.image.naturalHeight),e.selectedImage.canvas.width=Math.ceil(e.image.naturalWidth*i)-5,void(e.selectedImage.canvas.height=Math.ceil(e.image.naturalHeight*i)-5)}else{if(t<e.image.naturalWidth)return e.selectedImage.biggerThanContainer=!0,i=parseFloat(t)/parseFloat(e.image.naturalWidth),e.selectedImage.canvas.width=Math.ceil(e.image.naturalWidth*i)-5,void(e.selectedImage.canvas.height=Math.ceil(e.image.naturalHeight*i)-5);if(a<e.image.naturalHeight)return e.selectedImage.biggerThanContainer=!0,i=parseFloat(a)/parseFloat(e.image.naturalHeight),e.selectedImage.canvas.width=Math.ceil(e.image.naturalWidth*i)-5,void(e.selectedImage.canvas.height=Math.ceil(e.image.naturalHeight*i)-5)}if(t>e.image.naturalWidth||a>e.image.naturalHeight){e.selectedImage.biggerThanContainer=!1;var n=e.image.naturalWidth,s=e.image.naturalHeight;while(n<t-10&&s<a-10)n*=1.01,s*=1.01;e.selectedImage.canvas.width=n,e.selectedImage.canvas.height=s}},fnSelectImage:function(e){var t=this;t.isAllLabelCompleted?(t.selectedImage.canvas&&t.fnInitScale(),t.imageList.forEach((function(e){e.selected=!1,e.labelList&&e.labelList.length>0&&e.labelList.forEach((function(e){e.selected=!1}))})),t.imageList[e].selected=!0,t.selectedImageIndex=e,t.selectedImage=t.imageList[e],t.statusSaved=!1,t.statusText="이미지가 선택되었습니다. 라벨을 추가해주세요.",t.$forceUpdate(),t.metadata.metaclass=t.selectedImage.metadata.metaclass,t.metadata.subclass=t.selectedImage.metadata.subclass,t.metadata.area=t.selectedImage.metadata.area,t.metadata.device=t.selectedImage.metadata.device,t.metadata.weather=t.selectedImage.metadata.weather,t.metadata.illuminance=t.selectedImage.metadata.illuminance,t.metadata.light=t.selectedImage.metadata.light,t.metadata.outline=t.selectedImage.metadata.outline,t.metadata.wordorientation=t.selectedImage.metadata.wordorientation,t.metadata.wordsize=t.selectedImage.metadata.wordsize,t.metadata.wordfont=t.selectedImage.metadata.wordfont,t.metadata.wordcolor=t.selectedImage.metadata.wordcolor,t.metadata.wordconnection=t.selectedImage.metadata.wordconnection,t.selectedImage.canvas?l()(t.selectedImage.canvas).off():(t.selectedImage.canvas=l()("#labelCanvas"+e)[0],t.selectedImage.context=t.selectedImage.canvas.getContext("2d")),t.image=new Image,t.image.onload=function(){t.selectedImage.canvas.width=t.image.naturalWidth+1,t.selectedImage.canvas.height=t.image.naturalHeight+1,t.fnSetCanvasSize(),t.selectedImage.realImage=t.image,t.initCanvasWidth=t.selectedImage.canvas.width,t.initCanvasHeight=t.selectedImage.canvas.height,t.selectedImage.context.drawImage(t.image,0,0,t.image.width,t.image.height,0,0,t.selectedImage.canvas.width,t.selectedImage.canvas.height),t.selectedImage.width=t.image.naturalWidth,t.selectedImage.height=t.image.naturalHeight,t.fnSetCanvasEvent(),t.imageLoading=!1,t.fnDrawRectangle()},t.imageLoading=!0,t.$forceUpdate(),t.image.src=t.selectedImage.imageUrl):t.alert("완료되지 않은 라벨이 있습니다.")},fnLoadImage:function(){l()("#imageFiles").click()},fnImageLoaded:function(e){var t=this;if(e.target.files.length+t.imageList.length>10)t.alert("이미지는 10개 이하로만 등록 가능합니다.");else{for(var a,i,n,s=t.imageList.length-1,o=0;o<e.target.files.length;o++)a=e.target.files[o],i=e.target.files[o].name.substring(0,e.target.files[o].name.lastIndexOf(".")),n=e.target.files[o].name.substring(e.target.files[o].name.lastIndexOf(".")+1),t.imageList.push({seq:s+1,file:a,newFileName:i,fileName:i,path:a.path,fileExtension:n,selected:!1,metadata:{metaclass:"",subclass:"",area:"",device:"",weather:"",illuminance:"",light:"",outline:"",wordorientation:"",wordsize:"",wordfont:"",wordcolor:"",wordconnection:""}});t.$nextTick((function(){for(var a=0;a<e.target.files.length;a++){var i=URL.createObjectURL(e.target.files[a]);l()("#image"+(s+1+a)).attr("src",i),t.imageList[s+1+a].imageUrl=i}}))}},fnSetCanvasResize:function(){var e=this;if(e.selectedImage.canvas){var t=l()(e.selectedImage.canvas).width(),a=l()(e.selectedImage.canvas).height();if(e.initCanvasWidth<0&&e.initCanvasHeight<0)return;e.windowWidthRatio=t/e.initCanvasWidth,e.windowHeightRatio=a/e.initCanvasHeight,e.image&&(e.fnSetCanvasSize(),e.selectedImage.context.drawImage(e.image,0,0,e.image.width,e.image.height,0,0,e.selectedImage.canvas.width,e.selectedImage.canvas.height),e.fnDrawRectangle())}},registerEventsWhenMounted:function(){var e=this;e.EventBus.on("GO_BOUNDING_BOX",(function(){e.EventBus.emit("GO_BOUNDING_BOX_RESULT",!1)})),e.EventBus.on("GO_VERIFICATION",(function(){if(e.imageList&&e.imageList.length>0){var t=e.confirm("작업 중인 데이터가 모두 삭제됩니다. 이동 하시겠습니까?");e.EventBus.emit("GO_VERIFICATION_RESULT",t)}else e.EventBus.emit("GO_VERIFICATION_RESULT",!0)})),e.EventBus.on("GO_CAPTURE",(function(){if(e.imageList&&e.imageList.length>0){var t=e.confirm("작업 중인 데이터가 모두 삭제됩니다. 이동 하시겠습니까?");e.EventBus.emit("GO_CAPTURE_RESULT",t)}else e.EventBus.emit("GO_CAPTURE_RESULT",!0)})),l()(".label_tool_sel").hover((function(){Object.keys(e.selectedImage).length<1||l()(".label_tool_list").slideDown(100)}),(function(){l()(".label_tool_list").slideUp(100)})),l()(".tool_opt_list").hover((function(){Object.keys(e.selectedImage).length<1||l()(".tool_zoom_items").slideDown(100)}),(function(){l()(".tool_zoom_items").slideUp(100)}))}},K={name:"annotation-tool",components:G,mixins:C["b"]?[V]:[U],data:J,computed:Z,methods:q},Q=K,ee=(a("5d3b"),Object(Y["a"])(Q,i,n,!1,null,"09efb534",null));t["default"]=ee.exports},"3d5c":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"content-main"}},[a("div",{staticClass:"wrap_tool"},[a("div",{staticClass:"to_headersub"},[e.isElectron?a("div",{staticClass:"to_btn_wrap"},[a("button",{staticClass:"btn_to upload",attrs:{type:"button"},on:{click:e.fnOpenFiles}},[e._v("파일 열기")]),a("button",{staticClass:"btn_to",attrs:{type:"button"},on:{click:e.fnSaveVerifyResult}},[e._v("저장")]),a("input",{staticStyle:{display:"none"},attrs:{type:"file",multiple:"",id:"files",accept:"image/jpeg, image/png, application/json"},on:{change:e.fnImageLoaded}})]):e._e(),a("div",{staticClass:"to_dataset_name"},[e.datasetJson.info&&e.datasetJson.info.name?a("span",[e._v("데이터셋 명 : "+e._s(e.datasetJson.info.name))]):e._e()])]),a("div",{staticClass:"inner"},[a("div",{staticClass:"tool_box left"},[a("div",{staticClass:"upload_list",attrs:{"data-simplebar":""}},[a("ul",e._l(e.imageList,(function(t,i){return a("li",{key:i,on:{click:function(t){return e.fnSelectImage(i)}}},[a("div",{staticClass:"upload_thumb"},[a("div",{staticClass:"thumb_img",class:t.selected?"current":""},[a("div",{staticClass:"thumb_img_brd hover"}),a("img",{attrs:{id:"image"+i,src:t.imageUrl}})]),a("div",{staticClass:"thumb_name"},[a("span",{attrs:{title:t.fileName}},[e._v(e._s(t.fileName))])])])])})),0)])]),a("div",{staticClass:"tool_box center"},[a("div",{staticClass:"tool_head"},[a("div",{staticClass:"head_util"},[a("div",{staticClass:"tool_opt_list"},[e._m(0),a("ul",{staticClass:"tool_zoom_items"},[a("li",[a("em",{staticClass:"tool_option plus",attrs:{title:"확대"},on:{click:e.fnZoomIn}}),a("i",{staticClass:"blind"},[e._v("확대")])]),a("li",[a("em",{staticClass:"tool_option minus",attrs:{title:"축소"},on:{click:e.fnZoomOut}}),a("i",{staticClass:"blind"},[e._v("축소")])]),a("li",[a("em",{staticClass:"tool_option reset",attrs:{title:"원래대로"},on:{click:e.fnInitScale}}),a("i",{staticClass:"blind"},[e._v("원래대로")])])])]),a("div",{staticClass:"tool_opt_move",class:[!e.selectedImage.isCropped&&e.zoomCount>0?"active":"",e.isMoveMode?"on":""],attrs:{title:"이동"},on:{click:e.fnChangeModeMove}},[a("i",{staticClass:"blind"},[e._v("이동")])])]),a("div",{staticClass:"head_file"},[a("span",[e._v("파일명")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedImage.fileName,expression:"selectedImage.fileName"}],staticClass:"form_file_name",attrs:{type:"text",readonly:"",name:""},domProps:{value:e.selectedImage.fileName},on:{input:function(t){t.target.composing||e.$set(e.selectedImage,"fileName",t.target.value)}}}),a("em",[e._v("."+e._s(e.selectedImage.fileExtension))])])]),a("div",{staticClass:"tool_body"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.imageLoading||e.saveLoading,expression:"imageLoading || saveLoading"}],staticClass:"loading_container"},[a("div",{staticClass:"loader"}),e.imageLoading?a("p",{staticStyle:{"margin-top":"10px"}},[e._v("이미지를 불러오는 중입니다...")]):e.saveLoading?a("p",{staticStyle:{"margin-top":"10px"}},[e._v("데이터셋 저장 중입니다...")]):e._e()]),e._m(1)])]),a("div",{staticClass:"tool_box right verify"},[a("div",{staticClass:"tool_label"},[e._m(2),e.isElectron?a("div",{staticClass:"veri_result"},[a("div",{staticClass:"result_cont"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.selectedImage.failReason,expression:"selectedImage.failReason"}],attrs:{id:"failReason",placeholder:"Fail 사유를 입력해 주세요."},domProps:{value:e.selectedImage.failReason},on:{input:function(t){t.target.composing||e.$set(e.selectedImage,"failReason",t.target.value)}}})]),a("div",{staticClass:"result_tit"},[a("button",{staticClass:"btn_result",attrs:{type:"submit"},on:{click:function(t){return e.fnVerify(!0)}}},[e._v("Pass")]),a("button",{staticClass:"btn_result",attrs:{type:"submit"},on:{click:function(t){return e.fnVerify(!1)}}},[e._v("Fail")])])]):e._e(),a("div",{staticClass:"label_cont"},[a("div",{staticClass:"label_list",attrs:{"data-simplebar":""}},[a("div",{staticClass:"dataset_info"},[a("pre",[e._v("\t\t\t\t\t\t\t\t\t\t"),a("code",{domProps:{innerHTML:e._s(e.jsonString)}},[e._v("\n\t\t\t\t\t\t\t\t\t\t")]),e._v("\n\t\t\t\t\t\t\t\t\t")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isMetaDataNotNull,expression:"isMetaDataNotNull"}],staticClass:"tool_meta"},[e._m(3),a("div",{staticClass:"label_cont"},[a("div",{staticClass:"meta_list_wrap",attrs:{id:"simple"}},[a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("분류")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(" "+e._s(e.metadata.metaclass)+" ")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("세분류")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(" "+e._s(e.metadata.subclass)+" ")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("지역")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(e._s(e.metadata.area))])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("수집장치")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(e._s(e.metadata.device))])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("날씨")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(" "+e._s(e.metadata.weather)+" ")])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("조도")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(e._s(e.metadata.illuminance))])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("광원")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(e._s(e.metadata.light))])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("외곽선 선명도")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(e._s(e.metadata.outline))])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("글씨방향")]),a("select",{attrs:{disabled:""}},[a("option",{attrs:{value:"",disabled:"",selected:"",hidden:""}},[e._v(e._s(e.metadata.wordorientation))])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("글씨크기")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(e._s(e.metadata.wordsize))])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("글씨폰트")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(e._s(e.metadata.wordfont))])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("글자색")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(e._s(e.metadata.wordcolor))])])]),a("div",{staticClass:"meta_list"},[a("div",{staticClass:"meta_input_label"},[e._v("글자연결")]),a("select",{attrs:{disabled:""}},[a("option",[e._v(e._s(e.metadata.wordconnection))])])])])])])])])])])])]),e.imageLoading||e.saveLoading?a("div",{staticClass:"whole_dim"}):e._e()])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"option_head"},[a("em",{staticClass:"tool_option default",attrs:{title:"축소/확대 선택"}}),a("i",{staticClass:"blind"},[e._v("축소/확대 선택")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"canvas_container",attrs:{id:"canvasContainer"}},[a("canvas",{attrs:{id:"labelCanvas"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"label_tp"},[a("div",{staticClass:"tool_label_tit"},[e._v("라벨 정보")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"label_tp"},[a("div",{staticClass:"tool_label_tit"},[e._v("메타 데이터")])])}],s=(a("99af"),a("4de4"),a("7db0"),a("4160"),a("caad"),a("baa5"),a("b0c0"),a("4fad"),a("b64b"),a("d3b7"),a("25f0"),a("2532"),a("3ca3"),a("159b"),a("ddb0"),a("2b3d"),a("3835")),o=a("2909"),l=a("d4ec"),r=a("262e"),c=a("2caf"),d=a("9072"),u=a("1157"),m=a.n(u),v=(a("d81d"),a("96cf"),a("1da1")),h=a("bee2"),g=a("bc3a"),f=a.n(g),p=a("b279"),_=I,b={WORK:p["a"]?"http://localhost:5000/works":"/mgt/work/selectWorkAjax.do"};function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f.a.get(e,t)}function I(e){var t=a(e);return t.then((function(e){var t=e.data;switch(t.resultCode){case"success":return i(t.datasetList);case"error":O("데이터를 불러오지 못했습니다");break;default:O("Invalid resultCode: ".concat(t.resultCode))}})).catch((function(e){O("Invalid Error",e)}));function a(e){return w(b.WORK,{params:{work_id:e}})}function i(e){return e.map((function(e){return new C(e)}))}}var C=function(){function e(t){var a=t.FILE_ID,i=t.FILE_NM,n=t.FILE_URL,s=t.CONTENT_TYPE,o=t.SRT_ORD;Object(l["a"])(this,e),this.fileID=a,this.filename=i,this.fileURL=n,this.contentType=s,this.sortOrder=o}return Object(h["a"])(e,[{key:"fileObject",get:function(){try{return x(this.fileURL,this.filename,this.contentType).execute()}catch(e){throw e}}}]),e}();function x(e,t,a){if(i())return new L(e,t,a);if(n())return new M(e,t,a);throw new S("Invalid Content-type");function i(){return"application/json"===a.toLowerCase()}function n(){return a.toLowerCase().includes("image/")}}var y=function(){function e(t,a,i){Object(l["a"])(this,e),this.url=t,this.filename=a,this.contentType=i}return Object(h["a"])(e,[{key:"requestOfFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return w(e,t)}}]),e}(),L=function(e){Object(r["a"])(a,e);var t=Object(c["a"])(a);function a(){return Object(l["a"])(this,a),t.apply(this,arguments)}return Object(h["a"])(a,[{key:"execute",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.requestOfFile(this.url);case 2:return t=e.sent,e.abrupt("return",new File([JSON.stringify(t.data)],this.filename,{type:this.contentType}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(y),M=function(e){Object(r["a"])(a,e);var t=Object(c["a"])(a);function a(){return Object(l["a"])(this,a),t.apply(this,arguments)}return Object(h["a"])(a,[{key:"execute",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.requestOfFile(this.url,{responseType:"blob"});case 2:return t=e.sent,e.abrupt("return",new File([t.data],this.filename,{type:this.contentType}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(y);function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;throw new S(e,t)}var S=function(e){Object(r["a"])(a,e);var t=Object(c["a"])(a);function a(e,i){var n;return Object(l["a"])(this,a),n=t.call(this,e),n.cause=i,n.name="FetchDataSetError",n}return a}(Object(d["a"])(Error)),E="work_id",R={fnOpenFiles:function(){var e=this,t=p["a"]?"999":Object(p["c"])(E).value,a=_(t);a.then((function(t){var a=t.map((function(e){return e.fileObject}));Promise.all(a).then((function(t){return e.fnImageLoaded(t)}))})).catch((function(e){return alert(e)}))},fnImageLoaded:function(e){this.loadDatasetFiles(e)}},F=function(){var e=this;this.fnOpenFiles(),window.onresize=function(){e.fnSetCanvasResize()},this.registerEventsWhenMounted()},k={methods:R,mounted:F},B={fnOpenFiles:function(){document.getElementById("files").click()},fnImageLoaded:function(e){var t=Object(o["a"])(e.target.files);function i(e){var t=a("df7c");return e.path.substring(0,e.path.lastIndexOf(t.sep))}0!==t.length&&(this.directory=i(t[0]),this.loadDatasetFiles(t))},fnSaveVerifyResult:function(){var e=this;if(!e.imageList||e.imageList.length<1)e.alert("저장할 정보가 없습니다.");else if(e.imageList.length===e._.filter(e.imageList,(function(e){return e.isVerified})).length){e.saveLoading=!0;var t=a("df7c"),i=a("e8ae"),n=new i.Workbook,s=n.addWorksheet("검증 결과");s.getCell("A1").value="데이터셋 명",s.mergeCells("B1:D1"),s.getCell("D1").value=e.datasetJson.info.name,s.mergeCells("B2:D2"),s.getCell("A2").value="JSON 파일 명",s.getCell("D2").value=e.jsonFile.substring(e.jsonFile.lastIndexOf("/")+1),s.getRow(3).values=["이미지 파일 명","종류","Pass / Fail","Fail 사유"],s.columns=[{key:"이미지 파일 명"},{key:"종류"},{key:"Pass / Fail"},{key:"Fail 사유"}];var o={alignment:{horizontal:"center"},fill:{type:"pattern",pattern:"lightGray"},font:{bold:!0}};s.getCell("A1").style=o,s.getCell("A2").style=o,s.getCell("A3").style=o,s.getCell("B3").style=o,s.getCell("C3").style=o,s.getCell("D3").style=o,e.imageList.forEach((function(e){s.addRow({"이미지 파일 명":e.fileName+"."+e.fileExtension,"종류":e.isCropped?"Crop":"Select","Pass / Fail":e.isPassed?"Pass":"Fail","Fail 사유":e.failReason})}));var l=document.createElement("canvas"),r=l.getContext("2d");if(r){var c=[],d={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};s.eachRow((function(e,t){t<0||e.eachCell((function(e,t){if(e.border=d,"string"===typeof e.value){void 0===c[t]&&(c[t]=0);var a=e.font&&e.font.size?e.font.size:11;r.font="".concat(a,"pt Arial");var i=r.measureText(e.value),n=i.width;c[t]=Math.max(c[t],n)}}))}));for(var u=1;u<=s.columnCount;u++){var m=s.getColumn(u),v=c[u];v&&(m.width=v/7.5+1)}n.xlsx.writeBuffer().then((function(i){var n=e.directory+t.sep+e.datasetJson.info.name+".xlsx",s=a("3e8f").createWriteStream(n);s.write(i),s.end(),s.on("finish",(function(){e.saveLoading=!1,e.alert("저장 되었습니다.");var t=a("bdb9"),i=t.shell;i.openPath(e.directory)}))})).catch((function(t){e.saveLoading=!1,e.alert("저장 중 오류가 발생했습니다.\n오류 : "+t)}))}}else e.alert("검증이 완료되지 않은 이미지가 있습니다.")},fnVerify:function(e){var t=this;if(!e&&(!t.selectedImage.failReason||t.selectedImage.failReason.length<1))return t.alert("사유를 입력해주세요."),void m()("#failReason").focus();e&&(t.selectedImage.failReason=""),t.selectedImage.isVerified=!0,t.selectedImage.isPassed=e,t.selectedImageIndex+1<t.imageList.length&&t.fnSelectImage(t.selectedImageIndex+1)}},D=function(){var e=this;this.registerEventsWhenMounted();var t=a("bdb9").remote.getCurrentWindow();t.on("resize",(function(){e.fnSetCanvasResize()})),t.on("maximize",(function(){e.fnSetCanvasResize()})),t.on("unmaximize",(function(){e.fnSetCanvasResize()})),t.on("minimize",(function(){e.fnSetCanvasResize()})),t.on("restore",(function(){e.fnSetCanvasResize()}))},P={methods:B,mounted:D},T=function(){return{directory:"",initCanvasWidth:0,initCanvasHeight:0,windowWidthRatio:1,windowHeightRatio:1,image:null,saveLoading:!1,imageLoading:!1,canvas:null,context:null,mouseIsDown:!1,canvasInterval:null,rectangles:[],imageList:[],selectedImage:{},selectedImageIndex:-1,labelList:[],selectedLabel:{},selectedBbox:{},startX:0,startY:0,endX:0,endY:0,canvasScaleFactor:1.1,scaleFactor:null,zoomCount:0,zoomInExp:3,zoomOutExp:-3,imageMoveX:0,imageMoveY:0,isMoveMode:!1,datasetJson:{},jsonString:"",jsonFile:void 0,metadata:{metaclass:"",subclass:"",area:"",device:"",weather:"",illuminance:"",light:"",outline:"",wordorientation:"",wordsize:"",wordfont:"",wordcolor:"",wordconnection:""},isMetaDataNotNull:!1}},N={resetImageList:function(){this.imageList=[],this.jsonFile=null,this.selectedImageIndex=-1},loadDatasetFiles:function(e){this.resetImageList(),o();var t,a=this;try{t=n(e)}catch(u){return void a.alert("".concat(u.message,"(").concat(u.name,")"))}var i=e.filter((function(e){return e.type.includes("image/")}));function n(e){var t=function(e){Object(r["a"])(a,e);var t=Object(c["a"])(a);function a(e){var i;return Object(l["a"])(this,a),i=t.call(this,e),i.name="JSONExtractionError",i}return a}(Object(d["a"])(Error)),a=e.filter((function(e){return"application/json"===e.type}));if(!a||a.length<1)throw new t("JSON 파일이 존재하지 않습니다.");if(a.length>1)throw new t("JSON 파일은 해당 폴더에 하나만 있어야 합니다.");return a[0]}function s(e){var t=new Promise((function(t,a){var i=new FileReader;i.readAsText(e),i.onload=function(){t(i.result)},i.onerror=function(){a(i.error),i.abort()}}));return t}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"canvasContainer",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"canvas",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"labelCanvas",i=document.getElementById(e);while(i.firstChild)i.removeChild(i.lastChild);var n=document.createElement(t);n.id=a,i.append(n)}s(t).then((function(e){a.jsonString="",a.datasetJson=JSON.parse(e),a.jsonFile=t.name,a.fnSetImageList(i)})).catch((function(e){alert("JSON 파일을 읽지 못했습니다."),console.error(e)}))},fnSetImageList:function(e){var t,a,i,n=this;n.imageList=n.imageList||[];for(var s=0;s<e.length;s++)t=e[s],a=e[s].name.substring(t.name.lastIndexOf(".")+1),i=URL.createObjectURL(e[s]),n.imageList.push({file:t,newFileName:t.name.substring(0,t.name.lastIndexOf(".")),fileName:t.name.substring(0,t.name.lastIndexOf(".")),fileExtension:a,imageUrl:i,selected:!1,isCropped:t.name.lastIndexOf("_cropped_")>-1,isVerified:!1,isPassed:!1,failReason:""});n.fnSelectImage(0),n.windowWidthRatio=1,n.windowHeightRatio=1,n.fnDrawRectangle()},fnChangeModeMove:function(){var e=this;if(!e.selectedImage.isCropped){if(e.zoomCount<1)return e.isMoveMode=!1,void m()("#labelCanvas").css("cursor","default");e.isMoveMode=!e.isMoveMode,e.$forceUpdate(),e.$nextTick((function(){e.isMoveMode?m()("#labelCanvas").css("cursor","-webkit-grab"):m()("#labelCanvas").css("cursor","default")}))}},fnZoomIn:function(){var e=this;if(!(Object.keys(e.selectedImage).length<1)&&!(Math.abs(e.zoomCount)>4))if(e.zoomCount++,e.scaleFactor=Math.pow(e.canvasScaleFactor,e.zoomInExp),e.context.clearRect(0,0,e.selectedImage.width,e.selectedImage.height),e.selectedImage.isCropped){e.canvas.width=e.image.width*e.scaleFactor,e.image.width=e.image.width*e.scaleFactor,e.canvas.height=e.image.height*e.scaleFactor,e.image.height=e.image.height*e.scaleFactor,e.context.drawImage(e.image,0,0,e.canvas.width,e.canvas.height);var t=m()(".tool_body").height()/2-e.image.height/2;m()("#canvasContainer").css("padding-top",t+"px")}else e.context.scale(e.scaleFactor,e.scaleFactor),e.context.drawImage(e.image,0,0,e.image.width,e.image.height,0,0,e.canvas.width,e.canvas.height),e.fnDrawRectangle()},fnZoomOut:function(){var e=this;if(!(Object.keys(e.selectedImage).length<1)&&0!==e.zoomCount)if(e.zoomCount--,e.scaleFactor=Math.pow(e.canvasScaleFactor,e.zoomOutExp),e.context.clearRect(0,0,e.selectedImage.width,e.selectedImage.height),e.selectedImage.isCropped){e.canvas.width=e.image.width*e.scaleFactor,e.image.width=e.image.width*e.scaleFactor,e.canvas.height=e.image.height*e.scaleFactor,e.image.height=e.image.height*e.scaleFactor,e.context.drawImage(e.image,0,0,e.canvas.width,e.canvas.height);var t=m()(".tool_body").height()/2-e.image.height/2;m()("#canvasContainer").css("padding-top",t+"px")}else e.context.scale(e.scaleFactor,e.scaleFactor),0===e.zoomCount&&(e.imageMoveX=0,e.imageMoveY=0,e.context.setTransform(1,0,0,1,e.imageMoveX,e.imageMoveY),e.fnChangeModeMove()),e.context.drawImage(e.image,0,0,e.image.width,e.image.height,0,0,e.canvas.width,e.canvas.height),e.fnDrawRectangle()},fnInitScale:function(){var e=this;if(0!==e.zoomCount)if(e.zoomCount=0,e.selectedImage.isCropped){e.canvas.width=e.selectedImage.realImage.naturalWidth,e.canvas.height=e.selectedImage.realImage.naturalHeight,e.initCanvasWidth=e.canvas.width,e.initCanvasHeight=e.canvas.height,e.image.width=e.canvas.width,e.image.height=e.canvas.height;var t=m()(".tool_body").height()/2-e.image.height/2;m()("#canvasContainer").css("padding-top",t+"px"),e.context.drawImage(e.image,0,0,e.image.width,e.image.height,0,0,e.canvas.width,e.canvas.height)}else{var a=e.zoomCount>0;e.imageMoveX=0,e.imageMoveY=0;for(var i=0;i<Math.abs(e.zoomCount);i++)e.scaleFactor=Math.pow(e.canvasScaleFactor,a?e.zoomOutExp:e.zoomInExp),e.context.scale(e.scaleFactor,e.scaleFactor);e.context.setTransform(1,0,0,1,e.imageMoveX,e.imageMoveY),e.context.clearRect(0,0,e.selectedImage.width,e.selectedImage.height),e.fnChangeModeMove(),e.context.drawImage(e.image,0,0,e.image.width,e.image.height,0,0,e.canvas.width,e.canvas.height),e.fnDrawRectangle(),m()("#canvasContainer").css("padding-top","0")}},fnSetCanvasEvent:function(){var e=this;e.canvas.addEventListener("mousedown",e.fnMouseDown,!1),e.canvas.addEventListener("mousemove",e.fnMouseMove,!1),e.canvas.addEventListener("mouseup",e.fnMouseUp,!1)},fnMouseDown:function(){var e=this;e.mouseIsDown=!0,e.isMoveMode&&m()("#labelCanvas").css("cursor","-webkit-grabbing")},fnMouseMove:function(e){var t=this,a=t.zoomCount>0;if(t.mouseIsDown&&t.isMoveMode){var i=0;if(i=Math.pow(t.canvasScaleFactor,a?t.zoomInExp*t.zoomCount:t.zoomOutExp*Math.abs(t.zoomCount)),t.imageMoveX+=e.movementX,t.imageMoveY+=e.movementY,e.movementX>0&&e.movementY>0&&t.imageMoveX>0&&t.imageMoveY>0)return t.imageMoveX=0,void(t.imageMoveY=0);if(e.movementX>0&&t.imageMoveX>0)return void(t.imageMoveX=0);if(e.movementY>0&&t.imageMoveY>0)return void(t.imageMoveY=0);var n=Math.ceil(t.imageMoveX/(-1*(i-1))),s=Math.ceil(t.imageMoveY/(-1*(i-1)));if(t.imageMoveX<0&&t.imageMoveY<0&&n>t.canvas.width&&s>t.canvas.height)return t.imageMoveX=Math.ceil(t.canvas.width*(-1*(i-1))),void(t.imageMoveY=Math.ceil(t.canvas.height*(-1*(i-1))));if(n>t.canvas.width)return void(t.imageMoveX=Math.ceil(t.canvas.width*(-1*(i-1))));if(s>t.canvas.height)return void(t.imageMoveY=Math.ceil(t.canvas.height*(-1*(i-1))));t.context.clearRect(0,0,t.selectedImage.width,t.selectedImage.height),t.context.setTransform(i,0,0,i,t.imageMoveX,t.imageMoveY),t.context.drawImage(t.image,0,0,t.image.width,t.image.height,0,0,t.canvas.width,t.canvas.height),t.fnDrawRectangle()}},fnMouseUp:function(){var e=this;e.mouseIsDown&&(e.mouseIsDown=!1,e.isMoveMode&&m()("#labelCanvas").css("cursor","-webkit-grab"))},fnSetCanvasSize:function(){var e=this,t=m()("#canvasContainer").width(),a=m()("#canvasContainer").height(),i=0;if(t<e.image.naturalWidth&&a<e.image.naturalHeight){if(e.selectedImage.biggerThanContainer=!0,e.image.naturalWidth>e.image.naturalHeight)return i=parseFloat(t)/parseFloat(e.image.naturalWidth),e.canvas.width=Math.ceil(e.image.naturalWidth*i)-5,void(e.canvas.height=Math.ceil(e.image.naturalHeight*i)-5);if(e.image.naturalHeight>e.image.naturalWidth)return i=parseFloat(a)/parseFloat(e.image.naturalHeight),e.canvas.width=Math.ceil(e.image.naturalWidth*i)-5,void(e.canvas.height=Math.ceil(e.image.naturalHeight*i)-5)}else{if(t<e.image.naturalWidth)return e.selectedImage.biggerThanContainer=!0,i=parseFloat(t)/parseFloat(e.image.naturalWidth),e.canvas.width=Math.ceil(e.image.naturalWidth*i)-5,void(e.canvas.height=Math.ceil(e.image.naturalHeight*i)-5);if(a<e.image.naturalHeight)return e.selectedImage.biggerThanContainer=!0,i=parseFloat(a)/parseFloat(e.image.naturalHeight),e.canvas.width=Math.ceil(e.image.naturalWidth*i)-5,void(e.canvas.height=Math.ceil(e.image.naturalHeight*i)-5)}if(t>e.image.naturalWidth||a>e.image.naturalHeight){e.selectedImage.biggerThanContainer=!1;var n=e.image.naturalWidth,s=e.image.naturalHeight;while(n<t-10&&s<a-10)n*=1.01,s*=1.01;e.canvas.width=n,e.canvas.height=s}},fnSelectImage:function(e){var t=this;if(t.selectedImageIndex!==e){t.imageList.forEach((function(e){e.selected=!1})),t.imageList[e].selected=!0,t.selectedImageIndex=e,t.selectedImage=t.imageList[e],t.selectedImage.labelList=[],t.$forceUpdate(),t.canvas&&(m()(t.canvas).off(),t.canvas=void 0),t.canvas=m()("#labelCanvas")[0],t.context=t.canvas.getContext("2d"),t.image=new Image,t.image.onload=function(){if(t.zoomCount=0,t.selectedImage.realImage=t.image,t.canvas.width=t.selectedImage.realImage.naturalWidth,t.canvas.height=t.selectedImage.realImage.naturalHeight,m()("#canvasContainer").css("padding-top","0"),t.selectedImage.isCropped){var e=m()(".tool_body").height()/2-t.image.height/2;m()("#canvasContainer").css("padding-top",e+"px")}else t.fnSetCanvasSize();var a=t.fnGetRatio(t.selectedImage),i=t._.find(t.datasetJson.images,(function(e){return e.file_name===t.selectedImage.file.name})),n="-1";i&&i.id&&(n=i.id);var s=t._.filter(t.datasetJson.annotations,(function(e){return e.image_id===n})),o=t._.groupBy(s,"text"),l=function(e){var i=[];o[e].forEach((function(e){var n=e.bbox[0],s=e.bbox[1],o=e.bbox[2],l=e.bbox[3],r=t.selectedImage.biggerThanContainer?n/a:n*a,c=t.selectedImage.biggerThanContainer?s/a:s*a,d=t.selectedImage.biggerThanContainer?o/a:o*a,u=t.selectedImage.biggerThanContainer?l/a:l*a;i.push({startX:r,startY:c,width:d,height:u})})),t.selectedImage.labelList.push({type:"S",text:e,boundingBoxes:i})};for(var r in o)l(r);t.initCanvasWidth=t.canvas.width,t.initCanvasHeight=t.canvas.height,t.context.drawImage(t.image,0,0,t.image.width,t.image.height,0,0,t.canvas.width,t.canvas.height),t.fnSetCanvasEvent(),t.fnDrawRectangle(),t.imageLoading=!1},t.imageLoading=!0,t.$forceUpdate(),t.image.src=t.imageList[e].imageUrl;var a=[];t.datasetJson.images&&t.datasetJson.images.forEach((function(e){var i=t.selectedImage.fileName+"."+t.selectedImage.fileExtension;i===e.file_name&&a.push(e)})),t.jsonString="<br>images: "+JSON.stringify(a,null,4);var i=[];if(a.forEach((function(e){var a=t._.filter(t.datasetJson.annotations,(function(t){return t.image_id===e.id}));a&&i.push.apply(i,Object(o["a"])(a))})),t.jsonString+="<br>annotations: "+JSON.stringify(i,null,4),t.datasetJson.metadata?t.metadata=t.datasetJson.metadata:t.metadata={},t.isMetaDataNotNull=!1,t.datasetJson.metadata)for(var n=0,l=Object.entries(t.datasetJson.metadata);n<l.length;n++){var r=Object(s["a"])(l[n],2),c=r[0];r[1];if(""!==t.datasetJson.metadata[c]||t.datasetJson.metadata[c].length>0){t.isMetaDataNotNull=!0;break}}}},fnDrawRectangle:function(){var e=this;e.selectedImage.labelList&&e.selectedImage.labelList.length>0&&e.selectedImage.labelList.forEach((function(t){if("S"===t.type)t.boundingBoxes.forEach((function(a){a.selected?e.context.strokeStyle="#f33":(e.context.strokeStyle="#111","XXX"===t.text&&(e.context.strokeStyle="#0f0")),e.context.lineWidth=4,e.context.setLineDash([]),e.context.beginPath(),e.context.rect(a.startX*e.windowWidthRatio,a.startY*e.windowHeightRatio,a.width*e.windowWidthRatio,a.height*e.windowHeightRatio),e.context.closePath(),e.context.stroke()}));else{var a=t.boundingBox;a.selected?e.context.strokeStyle="#f33":e.context.strokeStyle="#111",e.context.globalAlpha=.1,e.context.fillRect(a.startX*e.windowWidthRatio,a.startY*e.windowHeightRatio,a.width*e.windowWidthRatio,a.height*e.windowHeightRatio),e.context.globalAlpha=1,e.context.setLineDash([5,3]),e.context.beginPath(),e.context.rect(a.startX*e.windowWidthRatio,a.startY*e.windowHeightRatio,a.width*e.windowWidthRatio,a.height*e.windowHeightRatio),e.context.closePath(),e.context.stroke()}}))},fnSetCanvasResize:function(){var e=this;if(e.canvas){var t=m()(e.canvas).width(),a=m()(e.canvas).height();if(e.initCanvasWidth<0&&e.initCanvasHeight<0)return;e.windowWidthRatio=t/e.initCanvasWidth,e.windowHeightRatio=a/e.initCanvasHeight,console.log(" windowWidthRatio = ",e.windowWidthRatio),console.log(" windowHeightRatio = ",e.windowHeightRatio),e.image&&e.context&&(e.fnSetCanvasSize(),e.context.drawImage(e.image,0,0,e.image.width,e.image.height,0,0,e.canvas.width,e.canvas.height),e.fnDrawRectangle())}},fnGetRatio:function(e){var t=m()("#canvasContainer").width(),a=m()("#canvasContainer").height();if(t<e.realImage.naturalWidth&&a<e.realImage.naturalHeight){if(e.realImage.naturalWidth>e.realImage.naturalHeight)return parseFloat(e.realImage.naturalWidth)/parseFloat(t);if(e.realImage.naturalHeight>e.realImage.naturalWidth)return parseFloat(e.realImage.naturalHeight)/parseFloat(a)}else{if(t<e.realImage.naturalWidth)return parseFloat(e.realImage.naturalWidth)/parseFloat(t);if(a<e.realImage.naturalHeight)return parseFloat(e.realImage.naturalHeight)/parseFloat(a)}if(t>e.realImage.naturalWidth||a>e.realImage.naturalHeight){var i=e.realImage.naturalWidth,n=e.realImage.naturalHeight,s=0;while(i<t-10&&n<a-10)s++,i*=1.01,n*=1.01;var o=1.01;s-=1;for(var l=0;l<s;l++)o*=1.01;return o}},registerEventsWhenMounted:function(){var e=this;e.EventBus.on("GO_BOUNDING_BOX",(function(){if(e.imageList&&e.imageList.length>0){var t=e.confirm("작업 중인 데이터가 모두 삭제됩니다. 이동 하시겠습니까?");e.EventBus.emit("GO_BOUNDING_BOX_RESULT",t)}else e.EventBus.emit("GO_BOUNDING_BOX_RESULT",!0)})),e.EventBus.on("GO_VERIFICATION",(function(){e.EventBus.emit("GO_VERIFICATION_RESULT",!1)})),e.EventBus.on("GO_CAPTURE",(function(){if(e.imageList&&e.imageList.length>0){var t=e.confirm("작업 중인 데이터가 모두 삭제됩니다. 이동 하시겠습니까?");e.EventBus.emit("GO_CAPTURE_RESULT",t)}else e.EventBus.emit("GO_CAPTURE_RESULT",!0)})),m()(".label_tool_sel").hover((function(){Object.keys(e.selectedImage).length<1||m()(".label_tool_list").slideDown(100)}),(function(){m()(".label_tool_list").slideUp(100)})),m()(".tool_opt_list").hover((function(){Object.keys(e.selectedImage).length<1||m()(".tool_zoom_items").slideDown(100)}),(function(){m()(".tool_zoom_items").slideUp(100)}))}},j={name:"verify-tool",mixins:p["b"]?[P]:[k],data:T,methods:N},z=j,X=(a("aa8b"),a("2877")),Y=Object(X["a"])(z,i,n,!1,null,"9f774a1e",null);t["default"]=Y.exports},"4bb1":function(e,t,a){},"4ee2":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),n=a("bc3a"),s=a.n(n),o=a("8c4f");i["a"].use(o["a"]);var l=new o["a"]({routes:[{path:"/",name:"tool-index",component:a("8753").default},{path:"/tool",name:"annotation-tool",component:a("37d8").default},{path:"/verify",name:"verify-tool",component:a("3d5c").default},{path:"/capture",name:"capture",component:a("1d34").default},{path:"*",redirect:"/"}]}),r=a("2ead"),c=a.n(r),d=a("9955"),u=a.n(d),m=a("2ef0"),v=a.n(m),h=(a("a6f9"),a("8195"),a("ecee")),g=a("ad3d"),f=a("c074"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[e.isElectron?[a("common-header"),a("router-view")]:[a("tool-body")]],2)},_=[],b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ts_header"},[e._m(0),a("div",{staticClass:"to_menu"},[a("ul",[a("li",[a("a",{staticClass:"lk_obj",attrs:{href:"javascript:;",title:"Bounding Box"},on:{click:e.fnGoBoundingBox}},[a("i"),e._v("Bounding Box ")])]),a("li",[a("a",{staticClass:"lk_veri",attrs:{href:"javascript:;",title:"Verification"},on:{click:e.fnGoVerification}},[a("i"),e._v("Verification ")])])])]),a("div",{staticClass:"ts_util"},[a("a",{staticClass:"user_capture",attrs:{href:"javascript:;",title:"Capture"},on:{click:e.fnGoCapture}},[a("i"),e._v("캡쳐 ")])])])},w=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ts_h1"},[a("h1",[a("a",{attrs:{href:"javascript:;"}},[e._v("Ko.AI OCR")])])])}],I=(a("b0c0"),{name:"Header",computed:{isIndexView:function(){return"tool-index"===this.$route.name}},methods:{fnGoBoundingBox:function(){var e=this;this.isIndexView&&this.$router.push("/tool"),this.EventBus.on("GO_BOUNDING_BOX_RESULT",(function(t){t&&e.$router.push("/tool")})),this.EventBus.emit("GO_BOUNDING_BOX")},fnGoVerification:function(){var e=this;this.isIndexView&&this.$router.push("/verify"),this.EventBus.on("GO_VERIFICATION_RESULT",(function(t){t&&e.$router.push("/verify")})),this.EventBus.emit("GO_VERIFICATION")},fnGoCapture:function(){var e=this;this.isIndexView&&this.$router.push("/capture"),this.EventBus.on("GO_CAPTURE_RESULT",(function(t){t&&e.$router.push("/capture")})),this.EventBus.emit("GO_CAPTURE")}}}),C=I,x=a("2877"),y=Object(x["a"])(C,b,w,!1,null,null,null),L=y.exports,M=a("37d8"),O=a("3d5c"),S=a("8753"),E=(a("b279"),{name:"annotation",components:{"common-header":L,"tool-body":R()}});function R(){switch("verify"){case"annotation":return M["default"];case"verify":return O["default"];default:return S["default"]}}var F=E,k=(a("034f"),Object(x["a"])(F,p,_,!1,null,null,null)),B=k.exports;h["d"].add(f["a"]),h["b"].watch(),i["a"].http=i["a"].prototype.$http=s.a,i["a"].config.productionTip=!1,a("b277"),a("4ee2"),a("cac4"),i["a"].component("font-awesome-icon",g["a"]),i["a"].use(c.a),i["a"].use(u.a,{name:"vueLodash",lodash:v.a}),i["a"].use(a("057a")),new i["a"]({router:l,moment:c.a,render:function(e){return e(B)}}).$mount("#app")},"5d3b":function(e,t,a){"use strict";a("2b9e")},"85ec":function(e,t,a){},8753:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"content-main"}},[a("div",{staticClass:"wrap_tool main"},[a("div",{staticClass:"inner"},[a("section",{staticClass:"open_main"},[a("ul",[a("li",[a("router-link",{class:"lk_obj",attrs:{to:"/tool",title:"Bounding Box"}},[a("i"),e._v("Bounding Box ")])],1),a("li",[a("router-link",{class:"lk_veri",attrs:{to:"/verify",title:"Verification"}},[a("i"),e._v("Verification ")])],1)])])])])])},n=[],s={name:"tool-index"},o=s,l=a("2877"),r=Object(l["a"])(o,i,n,!1,null,null,null);t["default"]=r.exports},a0dd:function(e,t,a){"use strict";a("de2b")},aa8b:function(e,t,a){"use strict";a("4bb1")},b277:function(e,t,a){},b279:function(e,t,a){"use strict";function i(e){var t=document.getElementById(e);return t||alert("Not found ID: ".concat(e)),{key:e,value:t.value}}a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return s}));var n=function(){return Object({NODE_ENV:"production",VUE_APP_TOOL_MODE:"verify",BASE_URL:"/common/verify/"}).IS_ELECTRON}(),s=function(){return!1}()},cac4:function(e,t,a){},de2b:function(e,t,a){}});